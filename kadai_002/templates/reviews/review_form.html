{% extends "base.html" %}
{% block title %}レビュー{% endblock %}

{% block content %}
<form method="post" class="container" novalidate>
  {% csrf_token %}

  <div class="mb-3">
    <label class="form-label">評価</label>
    {# ←★ここで form.rating は出さない！ #}
    {% with current=form.data.rating|default:form.initial.rating|default:form.instance.rating %}
    <fieldset class="rating" role="radiogroup" aria-label="星による評価">
      <input type="radio" id="star5" name="rating" value="5"
             {% if current|stringformat:"s" == "5" %}checked{% endif %}>
      <label for="star5" aria-label="5 stars"></label>

      <input type="radio" id="star4" name="rating" value="4"
             {% if current|stringformat:"s" == "4" %}checked{% endif %}>
      <label for="star4" aria-label="4 stars"></label>

      <input type="radio" id="star3" name="rating" value="3"
             {% if current|stringformat:"s" == "3" %}checked{% endif %}>
      <label for="star3" aria-label="3 stars"></label>

      <input type="radio" id="star2" name="rating" value="2"
             {% if current|stringformat:"s" == "2" %}checked{% endif %}>
      <label for="star2" aria-label="2 stars"></label>

      <input type="radio" id="star1" name="rating" value="1"
             {% if current|stringformat:"s" == "1" %}checked{% endif %}>
      <label for="star1" aria-label="1 star"></label>
    </fieldset>
    {% endwith %}
    {% if form.errors.rating %}<div class="text-danger small">{{ form.errors.rating }}</div>{% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label">タイトル</label>
    {{ form.title }}
    {% if form.errors.title %}<div class="text-danger small">{{ form.errors.title }}</div>{% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label">コメント</label>
    {{ form.comment }}
    {% if form.errors.comment %}<div class="text-danger small">{{ form.errors.comment }}</div>{% endif %}
  </div>

  <button type="submit" class="btn btn-primary btn-sm">保存</button>
</form>
{% endblock %}
